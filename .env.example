# Auth (required: do NOT use default credentials)
DASHBOARD_USERNAME=dashboard-admin
DASHBOARD_PASSWORD=replace-with-strong-random-password
JWT_SECRET=generate-a-random-64-char-string

# JWT signing algorithm (default: HS256)
# HS256 is recommended for single-service deployments. Switch to RS256 or ES256
# only when multiple services need independent token verification, or when
# compliance mandates asymmetric signing.
# JWT_ALGORITHM=HS256
# JWT_PRIVATE_KEY_PATH=./data/keys/jwt-private.pem
# JWT_PUBLIC_KEY_PATH=./data/keys/jwt-public.pem

# OIDC / SSO (optional — configure via Settings page)
# OIDC_ISSUER_URL=https://auth.example.com
# OIDC_CLIENT_ID=dashboard-client
# OIDC_CLIENT_SECRET=your-secret
# OIDC_REDIRECT_URI=http://localhost:5273/auth/callback

# Portainer
# For local development with Portainer on host: http://host.docker.internal:9000
# For remote Portainer: https://your-portainer.example.com
PORTAINER_API_URL=http://host.docker.internal:9000
PORTAINER_API_KEY=your-api-key
PORTAINER_VERIFY_SSL=false

# Ollama (external — not bundled in Docker Compose)
# For local Ollama on the host machine:
OLLAMA_BASE_URL=http://host.docker.internal:11434
# For a remote Ollama instance:
# OLLAMA_BASE_URL=http://your-ollama-host:11434
OLLAMA_MODEL=llama3.2

# For OpenWebUI or authenticated Ollama endpoints (optional):
# OLLAMA_API_ENDPOINT=https://your-openwebui.example.com/v1/chat/completions
# OLLAMA_BEARER_TOKEN=your-token-or-username:password
# Note: Use "username:password" for HTTP Basic auth, or a token for Bearer auth

# Kibana (optional)
# KIBANA_ENDPOINT=https://your-kibana.example.com
# KIBANA_API_KEY=your-kibana-key

# Monitoring
MONITORING_ENABLED=true
MONITORING_INTERVAL_MINUTES=5

# Metrics Collection
METRICS_COLLECTION_ENABLED=true
METRICS_COLLECTION_INTERVAL_SECONDS=60
METRICS_RETENTION_DAYS=7
PROMETHEUS_METRICS_ENABLED=false
# PROMETHEUS_BEARER_TOKEN=set-a-long-random-token-if-you-want-to-protect-metrics

# Anomaly Detection
ANOMALY_ZSCORE_THRESHOLD=3.0
ANOMALY_MOVING_AVERAGE_WINDOW=30
ANOMALY_MIN_SAMPLES=30
ANOMALY_COOLDOWN_MINUTES=15

# Predictive Alerting — proactive resource exhaustion warnings
PREDICTIVE_ALERTING_ENABLED=true
PREDICTIVE_ALERT_THRESHOLD_HOURS=24

# Anomaly Explanations — LLM explains anomalies in plain English
ANOMALY_EXPLANATION_ENABLED=true
ANOMALY_EXPLANATION_MAX_PER_CYCLE=5

# Isolation Forest ML Anomaly Detection
ISOLATION_FOREST_ENABLED=true
ISOLATION_FOREST_TREES=100
ISOLATION_FOREST_SAMPLE_SIZE=256
ISOLATION_FOREST_CONTAMINATION=0.1
ISOLATION_FOREST_RETRAIN_INTERVAL=6

# NLP Log Analysis — LLM analyzes container logs for error patterns
NLP_LOG_ANALYSIS_ENABLED=true
NLP_LOG_ANALYSIS_MAX_PER_CYCLE=3
NLP_LOG_ANALYSIS_TAIL_LINES=100

# Smart Alert Grouping — text similarity + LLM incident summaries
SMART_GROUPING_ENABLED=true
SMART_GROUPING_SIMILARITY_THRESHOLD=0.3
INCIDENT_SUMMARY_ENABLED=true

# Investigation (AI Root Cause Analysis)
INVESTIGATION_ENABLED=true
INVESTIGATION_COOLDOWN_MINUTES=30
INVESTIGATION_MAX_CONCURRENT=2
INVESTIGATION_LOG_TAIL_LINES=50
INVESTIGATION_METRICS_WINDOW_MINUTES=60

# Packet Capture (PCAP) — disabled by default, admin opt-in required
# PCAP_ENABLED=false
# PCAP_MAX_DURATION_SECONDS=300
# PCAP_MAX_FILE_SIZE_MB=50
# PCAP_MAX_CONCURRENT=2
# PCAP_RETENTION_DAYS=7
# PCAP_STORAGE_DIR=./data/pcap

# Cache
CACHE_ENABLED=true
CACHE_TTL_SECONDS=900
REDIS_URL=redis://redis:6379
REDIS_PASSWORD=CHANGE_ME_BEFORE_PRODUCTION
REDIS_KEY_PREFIX=aidash:cache:
# Redis server memory limit — evicts least-recently-used keys when full (allkeys-lru)
REDIS_MAXMEMORY=512mb

# TimescaleDB (metrics + KPI time-series storage)
# TimescaleDB runs as a Docker Compose sidecar for high-performance metrics queries.
# SQLite remains for users, sessions, settings, audit logs, insights, etc.
TIMESCALE_URL=postgresql://metrics_user:CHANGE_ME_BEFORE_PRODUCTION@timescaledb:5432/metrics
# TIMESCALE_MAX_CONNECTIONS=20
# METRICS_RAW_RETENTION_DAYS=7        # Raw 60s-interval data
# METRICS_ROLLUP_5MIN_RETENTION_DAYS=30
# METRICS_ROLLUP_1HOUR_RETENTION_DAYS=90
# METRICS_ROLLUP_1DAY_RETENTION_DAYS=365

# Server
PORT=3051
LOG_LEVEL=info
SQLITE_PATH=./data/dashboard.db

# Notifications — Microsoft Teams
# TEAMS_WEBHOOK_URL=https://your-org.webhook.office.com/webhookb2/...
# TEAMS_NOTIFICATIONS_ENABLED=false

# Notifications — Email (SMTP)
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_SECURE=true
# SMTP_USER=notifications@example.com
# SMTP_PASSWORD=your-smtp-password
# SMTP_FROM=AI Portainer Dashboard <notifications@example.com>
# EMAIL_NOTIFICATIONS_ENABLED=false
# EMAIL_RECIPIENTS=admin@example.com,ops@example.com

# eBPF Trace Ingestion (Grafana Beyla)
# Enable to accept OTLP traces from Beyla or other OpenTelemetry exporters
# See docker/beyla/beyla.yml for the Beyla sidecar configuration
# TRACES_INGESTION_ENABLED=false
# TRACES_INGESTION_API_KEY=  # Required when TRACES_INGESTION_ENABLED=true

# OpenTelemetry Span Export — forward spans to external collectors (Jaeger, Tempo, Datadog)
# When enabled, spans stored in SQLite are also batched and sent via OTLP/HTTP JSON.
# OTEL_EXPORTER_ENABLED=false
# OTEL_EXPORTER_ENDPOINT=http://jaeger:4318/v1/traces
# OTEL_EXPORTER_HEADERS={"Authorization":"Bearer your-token"}
# OTEL_EXPORTER_BATCH_SIZE=100
# OTEL_EXPORTER_FLUSH_INTERVAL_MS=5000

# Rate Limiting
# Global API requests per minute per IP (default: 600 in production, 1200 in development)
# API_RATE_LIMIT=1200
# Login attempts per minute (default: 5 in production, 30 in development)
# LOGIN_RATE_LIMIT=30

# Kali MCP (Docker Compose service)
# Comma-separated allowlist for the Kali MCP `run_allowed` tool
KALI_MCP_ALLOWED_COMMANDS=whoami,id,uname,ip,df,free,ps,ss,ls,cat

# NVD MCP (Security) — National Vulnerability Database CVE lookups
# Get a free API key at https://nvd.nist.gov/developers/request-an-api-key
# Without key: 5 req/30s — With key: 50 req/30s
# NVD_API_KEY=

# Snyk MCP (Security) — Vulnerability scanning (SCA, SAST, IaC, Container)
# Get a free token at https://app.snyk.io/account
# Free tier: 400 SCA + 100 Code + 300 IaC + 100 Container tests/month
# SNYK_TOKEN=
