name: Enforce branch policy

on:
  pull_request:
    branches: [main]

jobs:
  check-source-branch:
    name: Source branch check
    runs-on: ubuntu-latest
    steps:
      - name: Verify PR source is dev
        if: github.head_ref != 'dev'
        env:
          HEAD_REF: ${{ github.head_ref }}
        run: |
          echo "::error::PRs to main must come from the dev branch. Got: $HEAD_REF"
          exit 1
      - name: Source branch OK
        if: github.head_ref == 'dev'
        run: echo "PR source is dev â€” allowed."
